Metadata-Version: 2.4
Name: grundstueckgewinnsteuer-ch
Version: 0.1.0
Summary: Production-grade GrundstÃ¼ckgewinnsteuer (real-estate capital gains tax) calculator for all Swiss cantons and communes.
License-Expression: MIT
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: pydantic>=2.0
Requires-Dist: pyyaml>=6.0
Requires-Dist: streamlit>=1.30
Provides-Extra: dev
Requires-Dist: pytest>=8.0; extra == "dev"
Requires-Dist: ruff>=0.4; extra == "dev"

# GrundstÃ¼ckgewinnsteuer Calculator (CH)

A production-grade **GrundstÃ¼ckgewinnsteuer** (real-estate capital gains tax) calculator for all Swiss cantons and communes, built in Python with a Streamlit UI.

## Features

- âœ… **Schaffhausen (SH)** â€“ exact port of the [JS reference calculator](https://github.com/rinor-ab/steuerrechnerSHCH) with parity tests
- âœ… **ZÃ¼rich (ZH)** â€“ communal-uniform tariff model
- âœ… **Bern (BE)** â€“ Steuerfuss model with gain-reduction discount
- âœ… **Luzern (LU)** â€“ income-tariff based with 4.2 Steuereinheiten
- ðŸ”§ Data-driven plugin framework for adding more cantons
- ðŸ“Š Interactive Streamlit UI with detailed computation breakdown
- ðŸ“¥ JSON export of full computation results

## Quick Start

### Installation

```bash
# Clone the repo
git clone https://github.com/<your-user>/grundstueckgewinnsteuer-ch.git
cd grundstueckgewinnsteuer-ch

# Install with dev dependencies
pip install -e ".[dev]"
```

### Run Tests

```bash
pytest tests/ -v
```

### Lint

```bash
ruff check .
```

### Run Streamlit App

```bash
streamlit run streamlit_app/app.py
```

The app will open at `http://localhost:8501`.

## Deploy to Streamlit Cloud

1. Push the repo to GitHub
2. Go to [share.streamlit.io](https://share.streamlit.io)
3. Connect your GitHub repo
4. Set the main file path to `streamlit_app/app.py`
5. Deploy

## Project Structure

```
grundstueckgewinnsteuer/
â”œâ”€â”€ models.py              # Pydantic domain models (TaxInputs, TaxResult)
â”œâ”€â”€ engine/
â”‚   â”œâ”€â”€ base.py            # Abstract CantonEngine interface
â”‚   â”œâ”€â”€ tariff.py          # Generic bracket evaluator + helpers
â”‚   â””â”€â”€ rounding.py        # to_fixed_2, round_up_to_005
â”œâ”€â”€ cantons/
â”‚   â”œâ”€â”€ registry.py        # Canton engine registry
â”‚   â”œâ”€â”€ sh.py              # Schaffhausen (JS-parity port)
â”‚   â”œâ”€â”€ zh.py              # ZÃ¼rich
â”‚   â”œâ”€â”€ be.py              # Bern
â”‚   â””â”€â”€ lu.py              # Luzern
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ cantons/<code>/    # Tariff YAML per canton
â”‚   â””â”€â”€ communes/<code>/   # Steuerfuss JSON per canton
â”œâ”€â”€ sources/               # Official source docs per canton
streamlit_app/
â”‚   â””â”€â”€ app.py             # Streamlit UI
tests/                     # pytest suite
```

## Adding a New Canton

See [CANTON_CHECKLIST.md](CANTON_CHECKLIST.md) for the step-by-step template.

## Official Sources

Each canton has official sources documented in `grundstueckgewinnsteuer/sources/<canton>.md` with links to tax authority pages, laws, and leaflets.

## Architecture

- **Data-driven**: Tax rules are stored in YAML/JSON, not hardcoded
- **Decimal arithmetic**: All monetary calculations use `Decimal` for deterministic results
- **Plugin pattern**: Each canton implements `CantonEngine` and is auto-registered
- **Parity-tested**: Schaffhausen engine has 16+ golden-master tests against the JS reference

## License

MIT
